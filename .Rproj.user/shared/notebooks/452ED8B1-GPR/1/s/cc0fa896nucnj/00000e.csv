"0","# Some code"
"0","nu <- function(x,X,sigma = 1, l = 1){"
"0","  x <- as.matrix(x)"
"0","  X <- as.matrix(X)"
"0","  N <- nrow(x)"
"0","  n <- nrow(X)"
"0","  id <- diag(n)"
"0","  A <- solve(matrix_k(X,X,l) + sigma^2 * id)"
"0","  res <- 1:N %>% lapply(function(j){"
"0","    k <- cov_ker(x[j,],x[j,],l)"
"0","    vec_k <- matrix_k(matrix(x[j,],nrow = 1),X,l)"
"0","    y <- k - vec_k %*% A %*% t(vec_k)"
"0","    return(y[1,1])"
"0","  }) %>% unlist()"
"0","  return(res)"
"0","}"
