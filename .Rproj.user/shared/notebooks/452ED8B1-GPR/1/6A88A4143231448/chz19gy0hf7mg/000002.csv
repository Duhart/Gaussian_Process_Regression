"0","# Inputs:"
"0","# x: a vector of length N or a matrix of dimensions N x m."
"0","# X: a vector of length n or a matrix of dimensions n x m."
"0","# y: a vector of length n."
"0","# sigma: a number."
"0","# l: a number."
"0","# Outputs:"
"0","# A vector of length N "
"0","mu <- function(x,X,y,sigma = 1, l = 1, C = 1){"
"0","  if(is.null(dim(X))){"
"0","    N <- length(x)"
"0","    n <- length(X)"
"0","    m <- 1"
"0","  }else{"
"0","    N <- nrow(x)"
"0","    n <- nrow(X)"
"0","    m <- ncol(X)"
"0","  }"
"0","  res <- rep(0,N)"
"0","  id <- diag(n)"
"0","  A <- solve(matrix_k(X,X,l) + sigma^2 * id,y)"
"0","  if(is.null(dim(X))){"
"0","    res <- 1:N %>% lapply(function(j){"
"0","      aux <- matrix_k(x[j],X,l, C) %*% A"
"0","      return(aux[1,1])"
"0","    }) %>% unlist()"
"0","  }else{"
"0","    res <- 1:N %>% lapply(function(j){"
"0","      aux <- matrix_k(x[j,],X,l, C) %*% A"
"0","      return(aux[1,1])"
"0","    }) %>% unlist()"
"0","  }"
"0","  return(res)"
"0","}"
"0","## test"
"0","mu(df$adstocks,df$adstocks,df$y,1,1)"
"1"," [1]"
"1","  -7.148594e-01"
"1","  -8.394428e-01"
"1","  -6.455333e-01"
"1","  -2.027326e-01"
"1","  -1.003353e-01"
"1","  -1.205810e-01"
"1","
"
"1"," [7]"
"1","  -2.236561e-01"
"1"," -7.287753e-111"
"1","  -3.768859e-01"
"1","  -1.613867e-01"
"1","  -3.540925e-01"
"1","  -5.763398e-01"
"1","
"
"1","[13]"
"1","  -5.493061e-01"
"1","  -3.768859e-01"
"1","  -4.722308e-01"
"1","  -5.493061e-01"
"1","  -2.876821e-01"
"1","  -2.447741e-01"
"1","
"
"1","[19]"
"1","  -2.876821e-01"
"1","  -4.476920e-01"
"1","  -1.409256e-01"
"1","  -3.316471e-01"
"1","  -2.031350e-01"
"1","   1.538385e-84"
"1","
"
"1","[25]"
"1","  -1.409256e-01"
"1","  -1.409256e-01"
"1","   4.002135e-02"
"1","  -1.003353e-01"
"1","  -4.236489e-01"
"1","   1.003353e-01"
"1","
"
"1","[31]"
"1","  -3.540925e-01"
"1","  -3.768859e-01"
"1","  -2.236561e-01"
"1","  -3.768859e-01"
"1","  -4.236489e-01"
"1","  -1.205810e-01"
"1","
"
"1","[37]"
"1","  -4.973113e-01"
"1","  -1.205810e-01"
"1","  -4.236489e-01"
"1","  -3.768859e-01"
"1","  -4.236489e-01"
"1","  -4.258730e-01"
"1","
"
"1","[43]"
"1","  -4.339856e-01"
"1","  -4.421524e-01"
"1","  -3.540925e-01"
"1","  -4.002135e-02"
"1","  -2.027326e-01"
"1","  -1.205810e-01"
"1","
"
"1","[49]"
"1","  -2.314323e-01"
"1","  -3.316471e-01"
"1","  -2.661084e-01"
"1","  -2.661084e-01"
"1","  -6.041556e-01"
"1","  -4.236489e-01"
"1","
"
"1","[55]"
"1","  -6.624627e-01"
"1","  -6.041556e-01"
"1","  -6.328332e-01"
"1","  -5.493061e-01"
"1","  -6.041556e-01"
"1","  -9.076450e-01"
"1","
"
"1","[61]"
"1","  -6.624627e-01"
"1","  -8.291140e-01"
"1","  -7.250051e-01"
"1","  -1.293345e+00"
"1","  -5.229843e-01"
"1","  -8.777329e-01"
"1","
"
"1","[67]"
"1","  -6.624633e-01"
"1","  -1.293400e+00"
"1","  -6.353981e-01"
"1","  -1.113794e+00"
"1","  -9.360148e-01"
"1","  -8.527956e-01"
"1","
"
"1","[73]"
"1","  -6.687420e-01"
"1","  -1.194751e+00"
"1","  -1.148953e+00"
"1","
"
